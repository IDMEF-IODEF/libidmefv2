
/*****
*
* Copyright (C) 2004-2016 CS-SI. All Rights Reserved.
* Author: Yoann Vandoorselaere <yoann.v@prelude-ids.com>
* Author: Nicolas Delon <nicolas.delon@prelude-ids.com>
*
* This file is part of the Libidmefv2 library.
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation; either version 2, or (at your option)
* any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License along
* with this program; if not, write to the Free Software Foundation, Inc.,
* 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
*
*****/

/*
 * This file was automatically generated by our generator, version 1
 *
 * Do not make changes to this file unless you know what you are doing.
 * modify the template interface file instead.
 * IDMEFV2 version : Not released yet
 * Template file: generate-top-level-class-print-json.c.mako
 *
 */

#include "config.h"
#include "libmissing.h"

#include <stdio.h>
#include <string.h>

#include "idmefv2.h"
#include "idmefv2-tree-wrap.h"
#include "idmefv2-message-print-json.h"


#define conv_uint8 conv_uint64
#define conv_uint16 conv_uint64
#define conv_uint32 conv_uint64
#define conv_int8 conv_int64
#define conv_int16 conv_int64
#define conv_int32 conv_int64


static int conv_uint64(libidmefv2_io_t *fd, uint64_t value)
{
        int ret;
        char buf[32];

        ret = snprintf(buf, sizeof(buf), "%" LIBIDMEFV2_PRIu64, value);
        if ( ret < 0 || ret >= sizeof(buf) )
                return -1;

        return libidmefv2_io_write(fd, buf, ret);
}


static int conv_int64(libidmefv2_io_t *fd, int64_t value)
{
        int ret;
        char buf[32];

        ret = snprintf(buf, sizeof(buf), "%" LIBIDMEFV2_PRId64, value);
        if ( ret < 0 || ret >= sizeof(buf) )
                return -1;

        return libidmefv2_io_write(fd, buf, ret);
}


static int conv_float(libidmefv2_io_t *fd, float value)
{
        int ret;
        char buf[32];

        ret = snprintf(buf, sizeof(buf), "%f", value);
        if ( ret < 0 || ret >= sizeof(buf) )
                return -1;

        return libidmefv2_io_write(fd, buf, ret);
}


static int conv_string(libidmefv2_io_t *fd, libidmefv2_string_t *string)
{
        size_t i;
        ssize_t ret;
        const unsigned char *content;

        content = (const unsigned char *) libidmefv2_string_get_string_or_default(string, "");
        ret = libidmefv2_io_write(fd, "\"", 1);
        if ( ret < 0 )
                return ret;

        for ( i = 0; i < libidmefv2_string_get_len(string); i++, content++ ) {
                switch(*content) {
                        case '\\':
                        case '"':
                        case '/':
                                ret = libidmefv2_io_write(fd, "\\", 1);
                                if ( ret < 0 )
                                        return ret;

                                ret = libidmefv2_io_write(fd, content, 1);
                                break;
                        case '\b':
                                ret = libidmefv2_io_write(fd, "\\b", 2);
                                break;
                        case '\t':
                                ret = libidmefv2_io_write(fd, "\\t", 2);
                                break;
                        case '\n':
                                ret = libidmefv2_io_write(fd, "\\n", 2);
                                break;
                        case '\f':
                                ret = libidmefv2_io_write(fd, "\\f", 2);
                                break;
                        case '\r':
                                ret = libidmefv2_io_write(fd, "\\r", 2);
                                break;
                        default:
                                if ( *content >= 0x20 )
                                        ret = libidmefv2_io_write(fd, content, 1);
                                else {
                                        char seq[7];
                                        snprintf(seq, sizeof(seq), "\\u%04X", *content);
                                        ret = libidmefv2_io_write(fd, seq, strlen(seq));
                                }
                }

                if ( ret < 0 )
                        return ret;
        }

        return libidmefv2_io_write(fd, "\"", 1);
}


static int conv_time(libidmefv2_io_t *fd, idmefv2_time_t *t)
{
        int ret;
        libidmefv2_string_t *str;

        if ( ! t )
                return 0;

        ret = libidmefv2_string_new(&str);
        if ( ret < 0 )
                return ret;

        ret = idmefv2_time_to_string(t, str);
        if ( ret < 0 )
                goto error;

        ret = conv_string(fd, str);

error:
        libidmefv2_string_destroy(str);
        return ret;
}


static int conv_data(libidmefv2_io_t *fd, idmefv2_data_t *data)
{
        int ret;
        libidmefv2_string_t *out;

        ret = libidmefv2_string_new(&out);
        if ( ret < 0 )
                return ret;

        ret = idmefv2_data_to_string(data, out);
        if ( ret < 0 )
                goto error;

        switch (idmefv2_data_get_type(data)) {
                case IDMEFV2_DATA_TYPE_INT:
                case IDMEFV2_DATA_TYPE_FLOAT:
                        ret = libidmefv2_io_write(fd, libidmefv2_string_get_string(out), libidmefv2_string_get_len(out));
                        break;
                default:
                        ret = conv_string(fd, out);
                        break;
        }
error:
        libidmefv2_string_destroy(out);
        return ret;
}


static int do_write(libidmefv2_io_t *fd, const char *str)
{
        return libidmefv2_io_write(fd, str, strlen(str));
}
/**
 * idmefv2_address_json:
 * @ptr: Pointer to an idmefv2_address_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_address_print_json(idmefv2_address_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_address_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_address_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_address_get_translation(ptr);
{
                        const char *enumstr = idmefv2_address_translation_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"translation\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int i = idmefv2_address_get_category(ptr);
{
                        const char *enumstr = idmefv2_address_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_address_get_vlan_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"vlan_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_address_get_vlan_num(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"vlan_num\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_address_get_address(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"address\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_address_get_netmask(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"netmask\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_user_id_json:
 * @ptr: Pointer to an idmefv2_user_id_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_user_id_print_json(idmefv2_user_id_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_user_id_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_user_id_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_user_id_get_category(ptr);
{
                        const char *enumstr = idmefv2_user_id_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_user_id_get_tty(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"tty\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_user_id_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_user_id_get_number(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"number\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_node_name_json:
 * @ptr: Pointer to an idmefv2_node_name_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_node_name_print_json(idmefv2_node_name_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_node_name_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_node_name_get_category(ptr);
{
                        const char *enumstr = idmefv2_node_name_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_node_name_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_location_json:
 * @ptr: Pointer to an idmefv2_location_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_location_print_json(idmefv2_location_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_location_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_location_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                float *field;

                field = idmefv2_location_get_latitude(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"latitude\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_float(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                float *field;

                field = idmefv2_location_get_longitude(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"longitude\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_float(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                float *field;

                field = idmefv2_location_get_altitude(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"altitude\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_float(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_location_get_country(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"country\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_location_get_city(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"city\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_location_get_postcode(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"postcode\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_interface_json:
 * @ptr: Pointer to an idmefv2_interface_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_interface_print_json(idmefv2_interface_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_interface_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_interface_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_interface_get_category(ptr);
{
                        const char *enumstr = idmefv2_interface_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_interface_get_meaning(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"meaning\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_address_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_interface_get_next_address(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"address\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_address_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_file_access_json:
 * @ptr: Pointer to an idmefv2_file_access_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_file_access_print_json(idmefv2_file_access_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_file_access_t\"");
        if ( ret < 0 )
                return ret;

{
                idmefv2_user_id_t *field;

                field = idmefv2_file_access_get_user_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"user_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_user_id_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_file_access_get_permission(ptr);
{
                        const char *enumstr = idmefv2_file_access_permission_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"permission\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_inode_json:
 * @ptr: Pointer to an idmefv2_inode_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_inode_print_json(idmefv2_inode_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_inode_t\"");
        if ( ret < 0 )
                return ret;

        {
                uint32_t *field;

                field = idmefv2_inode_get_number(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"number\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_inode_get_major_device(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"major_device\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_inode_get_minor_device(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"minor_device\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_inode_get_c_major_device(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"c_major_device\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_inode_get_c_minor_device(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"c_minor_device\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_time_t *field;

                field = idmefv2_inode_get_change_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"change_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_checksum_json:
 * @ptr: Pointer to an idmefv2_checksum_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_checksum_print_json(idmefv2_checksum_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_checksum_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_checksum_get_value(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"value\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_checksum_get_key(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"key\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_checksum_get_algorithm(ptr);
{
                        const char *enumstr = idmefv2_checksum_algorithm_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"algorithm\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_stream_json:
 * @ptr: Pointer to an idmefv2_stream_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_stream_print_json(idmefv2_stream_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_stream_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_stream_get_offsetunit(ptr);
{
                        const char *enumstr = idmefv2_stream_offsetunit_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"offsetunit\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                uint32_t *field;

                field = idmefv2_stream_get_offset(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"offset\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_file_json:
 * @ptr: Pointer to an idmefv2_file_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_file_print_json(idmefv2_file_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_file_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_file_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_file_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_file_get_path(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"path\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_time_t *field;

                field = idmefv2_file_get_create_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"create_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_time_t *field;

                field = idmefv2_file_get_modify_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"modify_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_time_t *field;

                field = idmefv2_file_get_access_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"access_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint64_t *field;

                field = idmefv2_file_get_data_size(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"data_size\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint64(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint64_t *field;

                field = idmefv2_file_get_disk_size(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"disk_size\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint64(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_file_access_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_file_get_next_file_access(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"file_access\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_file_access_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_linkage_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_file_get_next_linkage(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"linkage\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_linkage_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_inode_t *field;

                field = idmefv2_file_get_inode(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"inode\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_inode_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_checksum_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_file_get_next_checksum(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"checksum\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_checksum_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_file_get_category(ptr);
{
                        const char *enumstr = idmefv2_file_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_file_get_file_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"file_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_container_t *field;

                field = idmefv2_file_get_container(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"container\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_container_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_stream_t *field;

                field = idmefv2_file_get_stream(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"stream\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_stream_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_linkage_json:
 * @ptr: Pointer to an idmefv2_linkage_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_linkage_print_json(idmefv2_linkage_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_linkage_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_linkage_get_category(ptr);
{
                        const char *enumstr = idmefv2_linkage_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_linkage_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_linkage_get_path(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"path\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_file_t *field;

                field = idmefv2_linkage_get_file(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"file\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_file_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_container_json:
 * @ptr: Pointer to an idmefv2_container_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_container_print_json(idmefv2_container_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_container_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_container_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_container_get_path(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"path\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_file_t *field;

                field = idmefv2_container_get_file(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"file\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_file_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_process_json:
 * @ptr: Pointer to an idmefv2_process_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_process_print_json(idmefv2_process_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_process_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_process_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_process_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_process_get_pid(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"pid\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_process_get_path(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"path\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                libidmefv2_string_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_process_get_next_arg(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"arg\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = conv_string(fd, elem);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                libidmefv2_string_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_process_get_next_env(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"env\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = conv_string(fd, elem);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_process_get_tid(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"tid\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_service_json:
 * @ptr: Pointer to an idmefv2_service_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_service_print_json(idmefv2_service_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_service_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_service_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_service_get_iana_protocol_number(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"iana_protocol_number\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_service_get_iana_protocol_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"iana_protocol_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_service_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_service_get_port(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"port\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_service_get_portlist(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"portlist\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_service_get_protocol(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"protocol\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_node_json:
 * @ptr: Pointer to an idmefv2_node_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_node_print_json(idmefv2_node_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_node_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_node_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_location_t *field;

                field = idmefv2_node_get_location(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"location\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_location_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_node_name_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_node_get_next_node_name(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"node_name\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_node_name_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_interface_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_node_get_next_interface(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"interface\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_interface_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_user_json:
 * @ptr: Pointer to an idmefv2_user_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_user_print_json(idmefv2_user_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_user_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_user_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_user_get_category(ptr);
{
                        const char *enumstr = idmefv2_user_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
{

                idmefv2_user_id_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_user_get_next_user_id(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"user_id\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_user_id_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_impact_type_json:
 * @ptr: Pointer to an idmefv2_impact_type_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_impact_type_print_json(idmefv2_impact_type_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_impact_type_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_impact_type_get_origin(ptr);
{
                        const char *enumstr = idmefv2_impact_type_origin_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"origin\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_impact_type_get_meaning(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"meaning\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_impact_type_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_impact_type_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_source_json:
 * @ptr: Pointer to an idmefv2_source_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_source_print_json(idmefv2_source_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_source_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_source_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_source_get_spoofed(ptr);
{
                        const char *enumstr = idmefv2_source_spoofed_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"spoofed\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

{
                idmefv2_node_t *field;

                field = idmefv2_source_get_node(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"node\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_node_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_user_t *field;

                field = idmefv2_source_get_user(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"user\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_user_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_process_t *field;

                field = idmefv2_source_get_process(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"process\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_process_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_service_t *field;

                field = idmefv2_source_get_service(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"service\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_service_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_target_json:
 * @ptr: Pointer to an idmefv2_target_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_target_print_json(idmefv2_target_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_target_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_target_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_target_get_decoy(ptr);
{
                        const char *enumstr = idmefv2_target_decoy_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"decoy\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

{
                idmefv2_node_t *field;

                field = idmefv2_target_get_node(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"node\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_node_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_user_t *field;

                field = idmefv2_target_get_user(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"user\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_user_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_process_t *field;

                field = idmefv2_target_get_process(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"process\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_process_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_service_t *field;

                field = idmefv2_target_get_service(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"service\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_service_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_file_t *field;

                field = idmefv2_target_get_file(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"file\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_file_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_original_data_json:
 * @ptr: Pointer to an idmefv2_original_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_original_data_print_json(idmefv2_original_data_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_original_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                idmefv2_time_t *field;

                field = idmefv2_original_data_get_timestamp(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"timestamp\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_original_data_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_data_t *field;

                field = idmefv2_original_data_get_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_data(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_node_t *field;

                field = idmefv2_original_data_get_node(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"node\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_node_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_file_t *field;

                field = idmefv2_original_data_get_file(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"file\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_file_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_observable_json:
 * @ptr: Pointer to an idmefv2_observable_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_observable_print_json(idmefv2_observable_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_observable_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_observable_get_origin(ptr);
{
                        const char *enumstr = idmefv2_observable_origin_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"origin\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_observable_get_meaning(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"meaning\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_observable_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_observable_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_taken_action_json:
 * @ptr: Pointer to an idmefv2_taken_action_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_taken_action_print_json(idmefv2_taken_action_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_taken_action_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_taken_action_get_category(ptr);
{
                        const char *enumstr = idmefv2_taken_action_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_reference_json:
 * @ptr: Pointer to an idmefv2_reference_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_reference_print_json(idmefv2_reference_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_reference_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_reference_get_origin(ptr);
{
                        const char *enumstr = idmefv2_reference_origin_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"origin\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_reference_get_meaning(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"meaning\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_reference_get_author(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"author\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_time_t *field;

                field = idmefv2_reference_get_publication_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"publication_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_reference_get_version(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"version\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_reference_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_reference_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_analyzer_json:
 * @ptr: Pointer to an idmefv2_analyzer_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_analyzer_print_json(idmefv2_analyzer_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_analyzer_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_analyzer_get_analyzerid(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"analyzerid\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_analyzer_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_analyzer_get_manufacturer(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"manufacturer\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_analyzer_get_model(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"model\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_analyzer_get_version(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"version\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_analyzer_get_class(ptr);
{
                        const char *enumstr = idmefv2_analyzer_class_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"class\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_analyzer_get_ostype(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ostype\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_analyzer_get_osversion(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"osversion\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_analyzer_get_ext_class(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_class\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_analyzer_get_analyzeraction(ptr);
{
                        const char *enumstr = idmefv2_analyzer_analyzeraction_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"analyzeraction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_analyzer_get_actionhistory(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"actionhistory\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_node_t *field;

                field = idmefv2_analyzer_get_node(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"node\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_node_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_process_t *field;

                field = idmefv2_analyzer_get_process(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"process\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_process_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_time_t *field;

                field = idmefv2_analyzer_get_analyzer_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"analyzer_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_additional_data_json:
 * @ptr: Pointer to an idmefv2_additional_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_additional_data_print_json(idmefv2_additional_data_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_additional_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_additional_data_get_meaning(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"meaning\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = idmefv2_additional_data_get_type(ptr);
{
                        const char *enumstr = idmefv2_additional_data_type_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                idmefv2_data_t *field;

                field = idmefv2_additional_data_get_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_data(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_correlation_alert_json:
 * @ptr: Pointer to an idmefv2_correlation_alert_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_correlation_alert_print_json(idmefv2_correlation_alert_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_correlation_alert_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_correlation_alert_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                libidmefv2_string_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_correlation_alert_get_next_alertident(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"alertident\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = conv_string(fd, elem);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_correlation_alert_get_duration(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"duration\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_correlation_alert_get_counter(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"counter\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_analysis_data_json:
 * @ptr: Pointer to an idmefv2_analysis_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_analysis_data_print_json(idmefv2_analysis_data_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_analysis_data_t\"");
        if ( ret < 0 )
                return ret;
{

                idmefv2_observable_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_analysis_data_get_next_observable(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"observable\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_observable_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_original_data_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_analysis_data_get_next_original_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"original_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_original_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_confidence_json:
 * @ptr: Pointer to an idmefv2_confidence_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_confidence_print_json(idmefv2_confidence_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_confidence_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_confidence_get_rating(ptr);
{
                        const char *enumstr = idmefv2_confidence_rating_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"rating\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_impact_json:
 * @ptr: Pointer to an idmefv2_impact_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_impact_print_json(idmefv2_impact_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_impact_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_impact_get_severity(ptr);
{
                        const char *enumstr = idmefv2_impact_severity_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"severity\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int i = idmefv2_impact_get_completion(ptr);
{
                        const char *enumstr = idmefv2_impact_completion_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"completion\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int i = idmefv2_impact_get_availability(ptr);
{
                        const char *enumstr = idmefv2_impact_availability_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"availability\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int i = idmefv2_impact_get_integrity(ptr);
{
                        const char *enumstr = idmefv2_impact_integrity_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"integrity\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int i = idmefv2_impact_get_confidentiality(ptr);
{
                        const char *enumstr = idmefv2_impact_confidentiality_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"confidentiality\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_impact_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_impact_type_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_impact_get_next_impact_type(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"impact_type\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_impact_type_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_recommanded_action_json:
 * @ptr: Pointer to an idmefv2_recommanded_action_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_recommanded_action_print_json(idmefv2_recommanded_action_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_recommanded_action_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = idmefv2_recommanded_action_get_action(ptr);
{
                        const char *enumstr = idmefv2_recommanded_action_action_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"action\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                uint32_t *field;

                field = idmefv2_recommanded_action_get_step(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"step\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_assessment_json:
 * @ptr: Pointer to an idmefv2_assessment_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_assessment_print_json(idmefv2_assessment_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_assessment_t\"");
        if ( ret < 0 )
                return ret;

{
                idmefv2_impact_t *field;

                field = idmefv2_assessment_get_impact(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"impact\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_impact_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_taken_action_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_assessment_get_next_taken_action(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"taken_action\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_taken_action_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_confidence_t *field;

                field = idmefv2_assessment_get_confidence(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"confidence\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_confidence_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_recommanded_action_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_assessment_get_next_recommanded_action(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"recommanded_action\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_recommanded_action_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_classification_json:
 * @ptr: Pointer to an idmefv2_classification_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_classification_print_json(idmefv2_classification_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_classification_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_classification_get_ident(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ident\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_classification_get_text(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"text\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_reference_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_classification_get_next_reference(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"reference\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_reference_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_heartbeat_json:
 * @ptr: Pointer to an idmefv2_heartbeat_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_heartbeat_print_json(idmefv2_heartbeat_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_heartbeat_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_heartbeat_get_messageid(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"messageid\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_analyzer_t *field;

                field = idmefv2_heartbeat_get_analyzer(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"analyzer\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_analyzer_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_time_t *field;

                field = idmefv2_heartbeat_get_create_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"create_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = idmefv2_heartbeat_get_heartbeat_interval(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"heartbeat_interval\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_heartbeat_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * idmefv2_alert_json:
 * @ptr: Pointer to an idmefv2_alert_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_alert_print_json(idmefv2_alert_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_alert_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_alert_get_messageid(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"messageid\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libidmefv2_string_t *field;

                field = idmefv2_alert_get_analyzerhash(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"analyzerhash\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_analyzer_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_alert_get_next_analyzer(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"analyzer\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_analyzer_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_time_t *field;

                field = idmefv2_alert_get_create_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"create_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_classification_t *field;

                field = idmefv2_alert_get_classification(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"classification\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_classification_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                idmefv2_time_t *field;

                field = idmefv2_alert_get_detect_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"detect_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_analysis_data_t *field;

                field = idmefv2_alert_get_analysis_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"analysis_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_analysis_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_source_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_alert_get_next_source(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"source\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_source_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_target_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_alert_get_next_target(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"target\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_target_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                idmefv2_assessment_t *field;

                field = idmefv2_alert_get_assessment(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"assessment\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = idmefv2_assessment_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                idmefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = idmefv2_alert_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = idmefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
        switch ( idmefv2_alert_get_type(ptr) ) {
        case IDMEFV2_ALERT_TYPE_CORRELATION:
                ret = do_write(fd, ", \"correlation_alert\": ");
                if ( ret < 0 )
                        return ret;

                ret = idmefv2_correlation_alert_print_json(idmefv2_alert_get_correlation_alert(ptr), fd);
                if ( ret < 0 )
                        return ret;
                break;
        default:
                break;
        }
return do_write(fd, "}");
}
/**
 * idmefv2_message_json:
 * @ptr: Pointer to an idmefv2_message_t object.
 *
 * This function will convert @ptr to a json,
 */
int idmefv2_message_print_json(idmefv2_message_t *ptr, libidmefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"idmefv2_message_t\"");
        if ( ret < 0 )
                return ret;

        {
                libidmefv2_string_t *field;

                field = idmefv2_message_get_version(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"version\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
        switch ( idmefv2_message_get_type(ptr) ) {
        case IDMEFV2_MESSAGE_TYPE_ALERT:
                ret = do_write(fd, ", \"alert\": ");
                if ( ret < 0 )
                        return ret;

                ret = idmefv2_alert_print_json(idmefv2_message_get_alert(ptr), fd);
                if ( ret < 0 )
                        return ret;
                break;
        case IDMEFV2_MESSAGE_TYPE_HEARTBEAT:
                ret = do_write(fd, ", \"heartbeat\": ");
                if ( ret < 0 )
                        return ret;

                ret = idmefv2_heartbeat_print_json(idmefv2_message_get_heartbeat(ptr), fd);
                if ( ret < 0 )
                        return ret;
                break;
        default:
                break;
        }
return do_write(fd, "}");
}
